# Export Package Config (エクスポートパッケージ設定)

## 概要

Export Package Configツールは、カスタムUnityパッケージ（`.unitypackage`）をエクスポートするための設定を定義および管理する方法を提供します。これはスクリプタブルオブジェクトを利用し、各アセットには、含めるアセットや除外するアセット、出力ファイルの名前付け方法、保存場所を決定するための一連の特定のルールが保持されます。

このツールは、チームメンバーとの共有、Asset Storeでの配布、またはバックアップ作成のためにプロジェクトアセットをパッケージ化するプロセスを簡素化および標準化するように設計されています。さまざまな設定アセットを作成することで、特定のアセットセットを一貫して簡単に再エクスポートできます。

## 主な機能

-   **スクリプタブルオブジェクトベースの設定:**
    -   複数の `ExportPackageConfig` アセットを作成して、さまざまなエクスポートシナリオ（例：「CharacterModels_Export」、「UI_Elements_Export」）を管理します。
    -   新しい設定を作成するには：プロジェクトウィンドウで右クリックし、`Create > Scriptableobject > ExportPackageConfig` を選択します。
-   **動的なエクスポートパス:**
    -   プレースホルダーを使用して、柔軟なエクスポートパスとファイル名を定義します:
        -   `<ProjectPath>`: Unityプロジェクトのルートディレクトリ（`Assets` フォルダの親）。
        -   `<AssetsPath>`: `Assets` フォルダのパス。
        -   `<ConfigName>`: `ExportPackageConfig` スクリプタブルオブジェクトアセット自体の名前。
        -   `<Date>`: `yyyyMMdd` 形式の現在の日付。
        -   `<Time>`: `HHmmss` 形式の現在の時刻。
    -   デフォルト例: `<ProjectPath>/ExportedPackages/<ConfigName>_<Date>.unitypackage`
-   **アセット包含ルール:**
    -   **Export Entry Assets (`exportEntryAssets`):** エクスポートする主要なアセットまたはフォルダをドラッグアンドドロップできるリスト。フォルダが追加された場合、そのフォルダ内のすべてのアセットがエントリポイントと見なされます。
    -   **Include Dependencies (`includeDependencies`):** ブール値のトグル（デフォルトはtrue）。有効にすると、指定した `exportEntryAssets`（および指定したフォルダ内のアセット）が依存するすべてのアセットが自動的にトレースされ、含まれます。
-   **アセット除外ルール:**
    -   **Exclude Assets (`excludeAssets`):** エクスポートリストから明示的に削除する必要があるアセットまたはフォルダをドラッグアンドドロップできるリスト。これらは、含まれるフォルダの一部であるか、他の含まれるアセットの依存関係であっても除外されます。
-   **自動フィルタリング:**
    -   `Packages/` ディレクトリ以下にあるアセット（つまり、Unity Package Managerによって管理されているアセット）は、エクスポートから自動的に除外されます。
-   **カスタムインスペクターインターフェース:**
    -   プロジェクトウィンドウで `ExportPackageConfig` アセットを選択すると、そのインスペクターには次のものが表示されます:
        -   `exportPathExpression`、`exportEntryAssets`、および `excludeAssets` を編集するためのフィールド。
        -   解決されたエクスポートパスを表示するボタン。これは、システムのファイルエクスプローラーでターゲットディレクトリを開くためのショートカットとしても機能します（ディレクトリが存在しない場合は作成されます）。
        -   エクスポートプロセスを開始するための主要な「unitypackageをパッケージを書き出す」ボタン。
        -   詳細なプレビューセクション:
            -   **「エントリーアセット一覧」:** 直接指定したアセット、または指定したフォルダ内にあるアセットを表示します。
            -   **「依存アセット一覧」:** 「Include Dependencies」設定により含まれるアセットを表示します。
            -   これらのリスト内のすべてのアセットパスはクリック可能で、プロジェクトウィンドウでアセットをpingしたり選択したりできます。
        -   エクスポートの一部として現在決定されているすべてのアセット（エントリと依存の両方）を選択するための「全選択」ボタン。
-   **インタラクティブなエクスポートプロセス:**
    -   エクスポートボタンをクリックすると、標準のUnity「Exporting package」ダイアログがトリガーされ、設定に基づいてアセットが事前に入力されます。これにより、`.unitypackage` ファイルが作成される前に最終的な確認と変更が可能になります。

## 使い方

1.  **エクスポート設定の作成:**
    *   Unityのプロジェクトウィンドウで右クリックします。
    *   `Create > Scriptableobject > ExportPackageConfig` に移動します。
    *   新しく作成されたスクリプタブルオブジェクトアセットに説明的な名前を付けます（例：`MyGame_CoreSystem_Config`）。

2.  **エクスポート設定の構成:**
    *   `ExportPackageConfig` アセットを選択します。その設定がインスペクターに表示されます。
    *   **出力するパッケージのパス (Export Path Expression):**
        *   `exportPathExpression` フィールドを変更します。利用可能なプレースホルダー（`<ConfigName>`、`<Date>`など）を使用して、パッケージの命名規則と出力ディレクトリを定義します。
        *   このフィールドの下のボタン（「エクスプローラーで開く...」と解決されたパスが続くラベル）を使用すると、パスを確認し、含まれるフォルダを開くことができます。
    *   **依存アセットを含める (Include Dependencies):**
        *   エントリーアセットのすべての依存関係を自動的に含めるには、このボックスをオンにします（デフォルト）。明示的にリストされたアセットのみが必要な場合は、オフにします。
    *   **パッケージに含めるアセット (Export Entry Assets):**
        *   特定のアセット（プレハブ、マテリアル、スクリプト、シーンなど）またはフォルダ全体をプロジェクトウィンドウからこのリストにドラッグアンドドロップします。これらはエクスポートの開始点です。
    *   **パッケージから除外するアセット (Exclude Assets):**
        *   パッケージに含めたくないアセットやフォルダをこのリストにドラッグアンドドロップします。これらは、「Export Entry Assets」フォルダ内にある場合や依存関係であっても除外されます。

3.  **アセットリストの確認:**
    *   インスペクターで、プレビューセクションまで下にスクロールします。
    *   **「エントリーアセット一覧」:** `exportEntryAssets` リストに基づいて直接含まれるアセットを確認します。
    *   **「依存アセット一覧」:** 「Include Dependencies」がアクティブな場合、自動的に取り込まれたアセットを確認します。
    *   これらのリスト内の任意のアセットパスをクリックすると、プロジェクトウィンドウで強調表示されます。
    *   より広範な概要が必要な場合は、**「全選択」** ボタンを使用して、現在リストされているすべてのアセットをプロジェクトウィンドウで選択します。

4.  **パッケージのエクスポート:**
    *   インスペクターの **「unitypackageをパッケージを書き出す」** ボタンをクリックします。
    *   標準のUnity「Exporting package」ウィンドウが表示されます。このウィンドウには、設定によって識別されたすべてのアセット（エントリーアセット + 依存関係 - 除外アセット）が事前に入力されています。
    *   必要に応じて、このダイアログで最終調整を行うことができます（例：アイテムのチェックを外す）。
    *   ダイアログの「Export...」ボタンをクリックします。
    *   ファイル保存ダイアログが表示され、`.unitypackage` ファイルの場所と名前の入力を求められます（`exportPathExpression` が解決したものにデフォルト設定されます）。
    *   場所を選択して「保存」をクリックします。
    *   確認メッセージ（「UnityPackageを書き出しました: [パス]」）がUnityコンソールに記録されます。

このツールは、`.unitypackage` ファイルを作成するための構造化された再利用可能な方法を提供し、一貫性を確保し時間を節約します。
