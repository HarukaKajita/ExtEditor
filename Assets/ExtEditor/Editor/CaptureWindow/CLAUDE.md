# CaptureWindow Tool

このファイルは、CaptureWindowツールでの作業時にClaude Codeへのガイダンスを提供します。

## ツール概要

CaptureWindowツールは、Unity内の様々なビューからスクリーンショットを撮影し、PNGファイルとして保存するエディター拡張です。Game View、Scene View、カスタムRenderTextureに対応しています。

## 主要機能

### 基本機能
- **マルチソース撮影**: Game View、Scene View、カスタムRenderTextureから撮影
- **カメラ選択**: シーンカメラから選択またはカスタムカメラを指定
- **アルファチャンネルサポート**: PNG出力時にアルファチャンネルを含める
- **透明背景**: 透明背景での撮影オプション
- **自動ファイル名**: タイムスタンプベースの命名（`Capture_yyyyMMdd_HHmmss.png`）
- **キーボードショートカット**: F9 + Cmd/Ctrl + Shift でクイック撮影

### 使用方法
1. **ツール → CaptureWindow**メニューからアクセス
2. 撮影ソースを選択（Game View/Scene View/RenderTexture）
3. ドロップダウンまたはObjectFieldからターゲットカメラを選択
4. 出力ディレクトリを設定（デフォルト: `../Captures`）
5. アルファチャンネルと背景オプションを設定
6. "Capture and Save PNG"をクリックまたはショートカットを使用
7. "Open Output Folder"で保存画像を確認

## 実装詳細

### ファイル構造
- **メインクラス**: `CaptureWindow` - EditorWindowの実装
- **単一ファイル**: 全機能が一つのファイルに集約

### 撮影メカニズム
- **RenderTexture**: すべての撮影操作にRenderTextureを使用
- **カメラ状態管理**: 撮影後に適切にカメラ状態を復元
- **複数撮影モード**: ウィンドウ撮影とショートカット撮影に対応

### 技術的特徴
- `EditorUtility.RevealInFinder()`による出力フォルダーの表示
- 出力ディレクトリの自動作成
- カメラ背景設定の撮影中の適切な管理
- キーボードショートカットの統合

## 設定詳細

### キーボードショートカット
- **ショートカット**: `F9 + Cmd/Ctrl + Shift`
- **機能**: 現在の設定でクイック撮影を実行

### 出力設定
- **デフォルト出力先**: Assetsフォルダの上位ディレクトリ（`../Captures`）
- **ファイル形式**: PNG（アルファチャンネル対応）
- **命名規則**: `Capture_yyyyMMdd_HHmmss.png`

### 撮影オプション
- **アルファチャンネル**: 透明度情報を含める
- **背景透明化**: 背景を透明にして撮影
- **カメラ選択**: Scene内のカメラまたはカスタムカメラ

## 開発ノート

### エラーハンドリング
- 出力ディレクトリ作成失敗時の処理
- カメラが見つからない場合の警告
- RenderTexture作成失敗時の処理

### パフォーマンス考慮
- RenderTextureの適切な解放
- 撮影時のカメラ状態の最小限の変更
- メモリ効率的な画像処理

### 拡張可能性
- 新しい撮影ソースの追加は`CaptureSource`enumと対応するメソッドで実装
- 出力形式の拡張は`SaveTextureToPNG`メソッドを参考に実装
- ショートカットの追加は`OnGUI`メソッドのイベント処理部分で実装