# BlendShape Fix Postprocessor (ブレンドシェイプ修正ポストプロセッサー)

## 概要

`BlendShapeFixPostProcessor` は、3Dモデルがプロジェクトにインポートまたは再インポートされる際に実行されるUnityエディタの自動ツールです。その主な機能は、各ブレンドシェイプ内のフレームがウェイトによって正しくソートされていることを保証することです。

一部の3Dモデリングワークフローや特定のファイル形式では、ブレンドシェイプのフレームが誤った順序でエクスポートされることがあります（例：100%の影響を意図したフレームが50%の影響を意図したフレームの前に現れるなど）。これは、Unityでこれらのブレンドシェイプがアニメーション化または操作される際に、不正確な補間や視覚的なアーティファクトを引き起こす可能性があります。

このポストプロセッサスクリプトは、インポートされたモデル内のすべての `SkinnedMeshRenderer` コンポーネントを自動的に検査します。各ブレンドシェイプについて、そのフレームがウェイトによってソートされているかどうかを確認します。誤ってソートされたブレンドシェイプが見つかった場合、スクリプトは次の処理を行います:
1.  すべてのフレームデータ（ウェイト、デルタ頂点、デルタ法線、デルタ接線）を読み取ります。
2.  フレームをウェイトに基づいて昇順にソートします。
3.  メッシュから既存の（誤った）ブレンドシェイプデータをクリアします。
4.  正しい順序でブレンドシェイプフレームをメッシュに再追加します。

## 使い方

このツールは自動的に動作します。プロジェクトにツールが含まれていることを確認する以外に、手動の操作は必要ありません。

1.  **統合:** `BlendShapeFixPostProcessor.cs` スクリプトがUnityプロジェクトの `Editor` フォルダ内（通常は `Assets/ExtEditor/Editor/BlendShapeFixpostProcessor/`）にあることを確認してください。
2.  **モデルのインポート:** ブレンドシェイプを含む新しい3Dモデル（例：FBX、DAE、OBJ）をインポートするか、既存のモデルを再インポートすると、このスクリプトはUnityのアセットインポートパイプラインの一部として自動的にトリガーされます。
3.  **自動修正:** スクリプトがウェイトによってソートされていないフレームを持つブレンドシェイプを検出すると、自動的に順序を修正します。このプロセスは通常サイレントです。修正が適用されたことを示す `Debug.Log` メッセージはスクリプト内でコメントアウトされていますが、必要に応じて診断目的で有効にすることができます。

このツールにはユーザーが設定可能な項目はありません。これは、一般的なブレンドシェイプのインポートの問題に対する「設定したら忘れてよい」ソリューションとして設計されています。
